<div class="feedback-container">
  <div class="feedback-card">
    <h1 class="feedback-title">Feedback-App</h1>
    <h2 class="feedback-subtitle">Envía tu Feedback Anónimo</h2>
    <p class="feedback-description">Tu opinión es importante. Comparte tu experiencia de forma anónima y ayuda a mejorar.</p>

    <div class="feedback-form">
      <div class="form-group">
        <label for="owner">¿A quién deseas enviar tu feedback?</label>
        @if (loadingOwners()) {
          <select id="owner" disabled class="loading-select">
            <option>Cargando...</option>
          </select>
        } @else {
          <select 
            id="owner" 
            (change)="onOwnerChange($event)"
            [class.is-invalid]="error() && !selectedOwnerId()"
          >
            <option value="">Selecciona un destinatario</option>
            @for (owner of owners(); track owner.id) {
              <option [value]="owner.id">{{ owner.username }}</option>
            }
          </select>
        }
      </div>

      <div class="form-group">
        <label for="message">Tu mensaje:</label>
        <textarea
          id="message"
          [(ngModel)]="message"
          placeholder="Escribe tu comentario o feedback aquí..."
          rows="6"
          [disabled]="loading()"
          [class.is-invalid]="error() && !message().trim()"
        ></textarea>
      </div>

      @if (error()) {
        <div class="alert-error">{{ error() }}</div>
      }

      @if (success()) {
        <div class="alert-success">{{ success() }}</div>
      }

      <button 
        type="button"
        (click)="submitFeedback()"
        [disabled]="loading() || loadingOwners()"
        class="btn-primary"
      >
        @if (loading()) {
          <span>Enviando...</span>
        } @else {
          <span>Enviar Feedback</span>
        }
      </button>
    </div>

    <div class="login-link">
      <span>¿Eres dueño de un negocio? </span>
      <a routerLink="/login" class="link">Inicia sesión</a>
    </div>
  </div>
</div>

